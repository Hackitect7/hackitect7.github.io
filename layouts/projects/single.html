{{ define "main" }}
  {{- $lang := .Site.Language.Lang -}}
  {{- $ui := (index site.Data $lang "ui") | default (index site.Data "us" "ui") -}}


  <!-- HERO -->
  <section class="hero section">
    <h1>{{ .Title }}</h1>
    {{ with .Params.description }}<p class="tagline">{{ . }}</p>{{ end }}
    {{ with .Params.badge }}<p class="sub">{{ . }}</p>{{ end }}
  </section>

  <!-- COVER (optional) -->
  {{ with .Params.cover }}
    <figure class="section card" style="padding:0; overflow:hidden">
      <img
        src="{{ . | relURL }}"
        alt="{{ $.Title }}"
        style="display:block; width:100%; height:auto"
      />
    </figure>
  {{ end }}


  <!-- META: stack + quick links (optional) -->
  {{ if or .Params.stack (or .Params.repo (or .Params.demo .Params.links)) }}
    <section class="section">
      <div class="grid">
        {{ with .Params.stack }}
          <div class="card">
            <h3>{{ or $ui.projects.stack "Stack" }}</h3>
            <ul>
              {{ range . }}<li>{{ . }}</li>{{ end }}
            </ul>
          </div>
        {{ end }}

        {{ if or .Params.repo (or .Params.demo .Params.links) }}
          <div class="card">
            <h3>{{ or $ui.projects.linksTitle "Links" }}</h3>
            <div class="cta-row">
              {{ with .Params.demo }}
                <a class="btn" href="{{ . }}"
                  >{{ or $ui.projects.demo "Live demo" }}</a
                >
              {{ end }}
              {{ with .Params.repo }}
                <a class="btn secondary" href="{{ . }}">GitHub</a>
              {{ end }}

              {{/* произвольные ссылки: links: [{text: "...", href: "...", kind: "secondary|tertiary"}] */}}
              {{ with .Params.links }}
                {{ range . }}
                  {{- $text := .text | default "Link" -}}
                  {{- $href := .href -}}
                  {{- $kind := .kind | default "tertiary" -}}
                  {{ if $href }}
                    <a class="btn {{ $kind }}" href="{{ $href }}"
                      >{{ $text }}</a
                    >
                  {{ end }}
                {{ end }}
              {{ end }}
            </div>
          </div>
        {{ end }}
      </div>
    </section>
  {{ end }}


  <!-- CONTENT -->
  <article class="section card">
    {{ .Content }}

    {{ with .Params.highlights }}
      <ul class="bullets" style="margin-top:12px">
        {{ range . }}<li>{{ . }}</li>{{ end }}
      </ul>
    {{ end }}
  </article>

  <!-- GALLERY (optional): images: ["/img1.jpg", {src:"/img2.jpg", alt:"..."}] -->
  {{ with .Params.images }}
    <section class="section">
      <div class="grid">
        {{ range . }}
          {{- $src := (cond (reflect.IsMap .) (.src) .) -}}
          {{- $alt := (cond (reflect.IsMap .) ((or .alt $.Title)) $.Title) -}}
          {{ if $src }}
            <figure class="card" style="padding:0; overflow:hidden">
              <img
                src="{{ $src | relURL }}"
                alt="{{ $alt }}"
                style="display:block; width:100%; height:auto"
              />
            </figure>
          {{ end }}
        {{ end }}
      </div>
    </section>
  {{ end }}


  <!-- PREV/NEXT -->
  <section class="section">
    <nav
      class="cta-row"
      aria-label="Project navigation"
      style="justify-content:space-between"
    >
      {{ if .PrevInSection }}
        <a class="btn secondary" href="{{ .PrevInSection.RelPermalink }}"
          >← {{ .PrevInSection.Title }}</a
        >
      {{ else }}
        <span></span>
      {{ end }}
      {{ with .NextInSection }}
        <a class="btn secondary" href="{{ .RelPermalink }}">{{ .Title }} →</a>
      {{ end }}
    </nav>
  </section>

  <!-- BACK TO LIST -->
  <section class="section card" style="text-align:center">
    <h2>{{ or $ui.projects.more "More projects" }}</h2>
    <a class="btn" href="{{ (printf "/%s/projects/" $lang) | relLangURL }}">
      {{ or $ui.projects.backToList "Back to projects" }}
    </a>
  </section>
{{ end }}
